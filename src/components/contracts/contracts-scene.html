<link rel="import" href="function-contracts-list.html">

<dom-module id="contracts-scene">
    <style>
        .offseted {
            margin-left: 30px;
        }
    </style>

    <template>

        <vaadin-split-layout id="verticalContractsSplitter" class$="splitter-3 [[getSplitterClass(selectedItem)]]">

            <iron-list id="filecontracts" items="[[contracts]]" as="file" selection-enabled selected-item="{{selectedItem}}">
                <template>
                    <div class="po-wrapper file-contract-line">
                        <div class="row">
                            <div class="mid">
                                [[file.name]]
                            </div>
                            <div class="right">
                                <span class="tag">[[file.functions.length]]</span>
                            </div>
                        </div>

                        <template is="dom-if" if="[[showAtLinePos(file, selected)]]">
                            <div class="offseted">
                                <function-contracts-list on-contract-function-selected='_onContractFunctionSelected' contracts="[[selectedItem.functions]]"></function-contracts-list>
                            </div>
                        </template>

                    </div>

                </template>
            </iron-list>

            <div id="right-panel" class="side">
                contract parameters [[selectedFunc.name]]
            </div>
        </vaadin-split-layout>

    </template>



    <script>
        Polymer({
            is: 'contracts-scene',
            properties: {
                contracts: {
                    type: Object
                },
                selectedFunc: Object,
                selectedItem: {
                    type: Object,
                    observer: "_onFileContractSelected"
                }
            },

            _onFileContractSelected: function (e) {
                console.log(e);
            },

            _onContractFunctionSelected: function (e) {
                console.log(e);
                this.selectedFunc = e.detail;
            },

            showAtLinePos: function (item, selected) {
                return selected;
            },

            getSplitterClass: function (selectedItem) {
                return (selectedItem) ? "" : "collapsed";
            },

        });
    </script>

    <style>
        .splitter-3 {
            --vaadin-split-layout-splitter: {
                min-width: 1px;
                min-height: 1px;
                border: solid 4px none;
                background-clip: content-box;
            }
        }

        .splitter-3 {
            --vaadin-split-layout-splitter: {
                background: var(--paper-tree-selected-background-color);
                fill: var(--paper-tree-selected-background-color);
            }
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
        }
    </style>
</dom-module>