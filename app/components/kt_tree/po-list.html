<link rel="import" href="po-icon.html">

<dom-module id="po-list">
    <template>

        <div class="container">
            <template is="dom-repeat" items="{{objects}}">
                <div on-click="_clickListener" class="po row" style$="background-color:var([[_getFillColor(item)]])">

                    <span class="po-id">{{item.id}}</span>
                    <template is="dom-if" if="[[!selectedFunction]]">
                        <span class="function-name">{{item.functionName}}</span>
                    </template>

                    <span class="predicate">{{item.predicate}}</span>
                    <span class="state">{{item.state}}</span>
                    <template is="dom-if" if="[[item.discharge]]">
                        :<span class="discharge">{{item.dischargeType}}</span>
                        <span class="discharge-comment">{{item.discharge.message}}</span>
                    </template>

                </div>

            </template>
        </div>

    </template>
</dom-module>

 <script>
    Polymer({
        is: 'po-list',

        properties: {
            selectedFile: Object,
            selectedFunction: Object,
            currentProject: Object,

            objects: {
                type: Array,
                computed: '_getPosBySelection(selectedFile,selectedFunction)'
            }
        },

        _getFillColor: function(node) {
            return "--kt-state-"+node.extendedState.toLowerCase()+"-bg";
        },

        _getPosBySelection: function(file, sfunction) {
            console.info(file);
            if (this.currentProject && file) {
                if(sfunction){
                    return this.currentProject.getPOsByFileFunc(file.relativePath, this.selectedFunction);
                } else {
                    return this.currentProject.getPOsByFile(file.relativePath);
                }

            } else {
                return [];
            }

        },

        _clickListener: function(e) {

            // if (this.selected) {     this.toggleClass("selected", false, this.selected);     this.selected = null; }
            //
            // this.toggleClass("selected", true, e.target); this.selected = e.target;

        }

    });
</script>
