<dom-module id="kt-stats">
    <template>

        <div class="container flex" style="display:flex">
            <paper-material elevation="1" class="card flexchild">
                <div id="poByRedicate" class="kt-chart"></div>
            </paper-material>

            <paper-material elevation="1" class="card flexchild">
                <div id="poByDischarge" class="kt-chart"></div>
            </paper-material>
        </div>

    </template>

    <style is="kt-stats">
        .flex {
            @apply(--layout-horizontal);
        }

        .flexchild {
            @apply(--layout-flex);
            padding: var(--spacer);
            margin: var(--spacer);
            background-color: var(--kt-panel-bg);
        }

        .kt-chart {
            width: 100%;
        }

    </style>

    <script>
        Polymer({
            is: 'kt-stats',

            properties: {
                selectedFile: Object,
                selectedFunction: Object,

                statistics: {
                    type: Object,
                    notify: true,
                    observer: '_statisticsChanged'
                },

                predicate: {
                    type: Object,
                    notify: true
                }
            },
            listeners: {
                "chart-bar-selected": "_chartBarSelected",
                "chart-row-selected": "_chartRowSelected"
            },

            _statisticsChanged: function(newVal, oldVal) {
                if (newVal) {
                    newVal.updateChart(this, d3.select("#poByRedicate"));
                    newVal.updatePoByDischargeChart(this, d3.select("#poByDischarge"));
                }
            },

            _chartBarSelected: function(event) {
                if (event.detail.src == this.$.poByRedicate) {
                    console.log(event.detail.row);
                    this.set("predicate", event.detail.row);
                }
            },

            _chartRowSelected: function(event) {
                console.log(event.detail);
            }

        });
    </script>

</dom-module>
